function getPeripheral (name)

	local p = {}
	
	for i = 1, #peripheral.getNames() do
		if peripheral.getType(peripheral.getNames()[i]) == name then
			p[#p + 1] = peripheral.wrap(peripheral.getNames()[i])
		end
	end
	
	return p
end

local d = true

function dbug (s)

	if d then print(tostring(s)) end
	
end

function main ()

	local interfaces = getPeripheral("tileinterface")
	local items = interfaces[1].getAvailableItems("proxy")
	
	for a, item in pairs(items) do
	
		if item.fingerprint.id ~= "IC2:itemScrap" then
			
			local qty = item.item.basic().qty
			local max_size = item.item.basic().max_size
			
			for b, interface in pairs(interfaces) do
				
				if qty > 0  then
					interface.exportItem(item.fingerprint, "down", max_size)
					qty = qty - max_size
					dbug(qty)
				else
					break
				end
				
				if qty > 0 then
					interface.exportItem(item.fingerprint, "up", max_size)
					qty = qty - max_size
					dbug(qty)
				else
					break
				end
				
			end
			
			break
			
		end
		
	end
	
end

while true do

	main()
	os.sleep(10)
	
end